name: Build & Test

on: [push]

jobs:
  cypress-run:
    runs-on: ubuntu-latest
    container: cypress/browsers:node14.17.0-chrome91-ff89
    steps:
      - uses: actions/checkout@v2
      - uses: cypress-io/github-action@v2
        with:
          build: npm run build
          start: npm run cy:run:reporter

      - uses: actions/upload-artifact@v2
        with:
          path: |
            - cypress/videos/**/*.mp4
            - cypress/screenshots/**/*.png
            - cypress/test-results/**/*.html
#           expire_in: 1 day
#           when: always
          
# jobs:
#   cache-npm-build:
#     runs-on: ubuntu-20.04

#     steps:
#       - name: Checkout
#         uses: actions/checkout@v2
#           with:
#             build: npm run build

#       - name: Install dependencies
#         run: npm install

#       - name: Cache dependencies
#         uses: actions/cache@v2
#         with:
#           build: npm run build

#   test-cypress:
#     needs: cache-npm-build
#     runs-on: ubuntu-20.04
#     container: cypress/browsers:node14.17.0-chrome91-ff89
#     steps:
#       - uses: cypress-io/github-action@v2
#         with:
#           start: npm run cy:run:reporter

# - uses: actions/checkout@v2
# #       - uses: cypress-io/github-action@v2
# #         with:
# #           build: npm run build
# #           start: npm run cy:run:reporter
